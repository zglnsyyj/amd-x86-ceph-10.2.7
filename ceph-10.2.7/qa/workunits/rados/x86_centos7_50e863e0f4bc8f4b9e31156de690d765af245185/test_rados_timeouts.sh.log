+ delay_mon omap rados lspools
+ MSGTYPE=omap
+ shift
+ rados lspools --rados-mon-op-timeout 1 --ms-inject-delay-type mon --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type omap
2018-03-05 13:58:26.898863 7f73939daa40  0 monclient(hunting): authenticate timed out after 300
2018-03-05 13:58:26.898961 7f73939daa40  0 librados: client.admin authentication error (110) Connection timed out
couldn't connect to cluster: (110) Connection timed out
+ '[' 1 -eq 0 ']'
+ delay_mon poolopreply rados mkpool test
+ MSGTYPE=poolopreply
+ shift
+ rados mkpool test --rados-mon-op-timeout 1 --ms-inject-delay-type mon --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type poolopreply
2018-03-05 14:03:26.921181 7f3d75d34a40  0 monclient(hunting): authenticate timed out after 300
2018-03-05 14:03:26.921262 7f3d75d34a40  0 librados: client.admin authentication error (110) Connection timed out
couldn't connect to cluster: (110) Connection timed out
+ '[' 1 -eq 0 ']'
+ delay_mon poolopreply rados mksnap -p test snap
+ MSGTYPE=poolopreply
+ shift
+ rados mksnap -p test snap --rados-mon-op-timeout 1 --ms-inject-delay-type mon --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type poolopreply
2018-03-05 14:08:26.946817 7f96ddb7ca40  0 monclient(hunting): authenticate timed out after 300
2018-03-05 14:08:26.946896 7f96ddb7ca40  0 librados: client.admin authentication error (110) Connection timed out
couldn't connect to cluster: (110) Connection timed out
+ '[' 1 -eq 0 ']'
+ delay_mon poolopreply rados rmpool test test --yes-i-really-really-mean-it
+ MSGTYPE=poolopreply
+ shift
+ rados rmpool test test --yes-i-really-really-mean-it --rados-mon-op-timeout 1 --ms-inject-delay-type mon --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type poolopreply
2018-03-05 14:13:26.970604 7f100ea32a40  0 monclient(hunting): authenticate timed out after 300
2018-03-05 14:13:26.970660 7f100ea32a40  0 librados: client.admin authentication error (110) Connection timed out
couldn't connect to cluster: (110) Connection timed out
+ '[' 1 -eq 0 ']'
+ delay_mon getpoolstats rados df
+ MSGTYPE=getpoolstats
+ shift
+ rados df --rados-mon-op-timeout 1 --ms-inject-delay-type mon --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type getpoolstats
2018-03-05 14:18:26.993252 7f0b660fea40  0 monclient(hunting): authenticate timed out after 300
2018-03-05 14:18:26.993314 7f0b660fea40  0 librados: client.admin authentication error (110) Connection timed out
couldn't connect to cluster: (110) Connection timed out
+ '[' 1 -eq 0 ']'
+ delay_mon mon_command ceph df
+ MSGTYPE=mon_command
+ shift
+ ceph df --rados-mon-op-timeout 1 --ms-inject-delay-type mon --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type mon_command
2018-03-05 14:23:27.075233 7efc4c4f9700  0 monclient(hunting): authenticate timed out after 300
2018-03-05 14:23:27.075277 7efc4c4f9700  0 librados: client.admin authentication error (110) Connection timed out
Error connecting to cluster: TimedOut
+ '[' 1 -eq 0 ']'
+ delay_mon omap ceph osd dump
+ MSGTYPE=omap
+ shift
+ ceph osd dump --rados-mon-op-timeout 1 --ms-inject-delay-type mon --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type omap
2018-03-05 14:28:27.194456 7f147ab2e700  0 monclient(hunting): authenticate timed out after 300
2018-03-05 14:28:27.194508 7f147ab2e700  0 librados: client.admin authentication error (110) Connection timed out
Error connecting to cluster: TimedOut
+ '[' 1 -eq 0 ']'
+ delay_mon omap ceph -s
+ MSGTYPE=omap
+ shift
+ ceph -s --rados-mon-op-timeout 1 --ms-inject-delay-type mon --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type omap
2018-03-05 14:33:27.292188 7f7ba1241700  0 monclient(hunting): authenticate timed out after 300
2018-03-05 14:33:27.292264 7f7ba1241700  0 librados: client.admin authentication error (110) Connection timed out
Error connecting to cluster: TimedOut
+ '[' 1 -eq 0 ']'
+ delay_osd osd_op_reply rados -p data put ls /bin/ls
+ MSGTYPE=osd_op_reply
+ shift
+ rados -p data put ls /bin/ls --rados-osd-op-timeout 1 --ms-inject-delay-type osd --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type osd_op_reply
error opening pool data: (2) No such file or directory
+ '[' 1 -eq 0 ']'
+ delay_osd osd_op_reply rados -p data get ls -
+ MSGTYPE=osd_op_reply
+ shift
+ rados -p data get ls - --rados-osd-op-timeout 1 --ms-inject-delay-type osd --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type osd_op_reply
error opening pool data: (2) No such file or directory
+ '[' 1 -eq 0 ']'
+ delay_osd osd_op_reply rados -p data ls
+ MSGTYPE=osd_op_reply
+ shift
+ rados -p data ls --rados-osd-op-timeout 1 --ms-inject-delay-type osd --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type osd_op_reply
error opening pool data: (2) No such file or directory
+ '[' 1 -eq 0 ']'
+ delay_osd command_reply ceph tell osd.0 bench 1 1
+ MSGTYPE=command_reply
+ shift
+ ceph tell osd.0 bench 1 1 --rados-osd-op-timeout 1 --ms-inject-delay-type osd --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type command_reply
Error ETIMEDOUT: problem getting command descriptions from osd.0
+ '[' 110 -eq 0 ']'
+ rbd create -s 1 test
+ delay_osd osd_op_reply rbd watch test
+ MSGTYPE=osd_op_reply
+ shift
+ rbd watch test --rados-osd-op-timeout 1 --ms-inject-delay-type osd --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type osd_op_reply
2018-03-05 14:33:31.196336 7ff6d4cf2700 -1 librbd::image::OpenRequest: failed to stat v2 image header: (110) Connection timed out
2018-03-05 14:33:31.196425 7ff6cffff700 -1 librbd::ImageState: 0x7ff6fdd6c950 failed to open image: (110) Connection timed out
rbd: error opening image test: (110) Connection timed out
+ '[' 110 -eq 0 ']'
+ delay_osd osd_op_reply rbd info test
+ MSGTYPE=osd_op_reply
+ shift
+ rbd info test --rados-osd-op-timeout 1 --ms-inject-delay-type osd --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type osd_op_reply
2018-03-05 14:33:32.223268 7f7b1e7fc700 -1 librbd::image::OpenRequest: failed to stat v2 image header: (110) Connection timed out
2018-03-05 14:33:32.223373 7f7b1dffb700 -1 librbd::ImageState: 0x7f7b4bd5ce90 failed to open image: (110) Connection timed out
rbd: error opening image test: (110) Connection timed out
+ '[' 110 -eq 0 ']'
+ delay_osd osd_op_reply rbd snap create test@snap
+ MSGTYPE=osd_op_reply
+ shift
+ rbd snap create test@snap --rados-osd-op-timeout 1 --ms-inject-delay-type osd --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type osd_op_reply
2018-03-05 14:33:33.251261 7f983ffff700 -1 librbd::image::OpenRequest: failed to stat v2 image header: (110) Connection timed out
2018-03-05 14:33:33.251364 7f983f7fe700 -1 librbd::ImageState: 0x7f986c16c260 failed to open image: (110) Connection timed out
rbd: error opening image test: (110) Connection timed out
+ '[' 110 -eq 0 ']'
+ delay_osd osd_op_reply rbd import /bin/ls ls
+ MSGTYPE=osd_op_reply
+ shift
+ rbd import /bin/ls ls --rados-osd-op-timeout 1 --ms-inject-delay-type osd --ms-inject-delay-max 10000000 --ms-inject-delay-probability 1 --ms-inject-delay-msg-type osd_op_reply
rbd: image creation failed
Importing image: 0% complete...failed.
2018-03-05 14:33:34.277142 7faa126b9d80 -1 librbd: Could not tell if ls already exists
rbd: import failed: (110) Connection timed out
+ '[' 110 -eq 0 ']'
+ rbd rm test
Removing image: 100% complete...done.
+ echo OK
OK
